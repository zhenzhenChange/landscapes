# Architecture Road: Framework Design

2022 年年底的时候有过这样的想法，搜寻过一些资料，但有关于“框架设计”的资料感觉有些稀少，这类问题可能是属于那种“火候未到，现在告诉你也没用”系列。

不过当时也有向几位大佬请教过这类问题，最近也读过《JavaScript 框架设计》一书。

现在呢，就结合本人的一些不成熟的构（huàn）思（xiǎng），先给自己挖个坑，说不定未来能够证道以此明我道心呢？

由于本文的内容大多数都是虚拟创作，并不是说我已经设计并开发出了一个框架之后才得出的结论，难免会有不合理之处，各位看官可酌情批评斧正。

在此之前，我们先立个大假设前提：结合个人理解，充分发挥想象力，拥有实现一切的能力。

先来个图辅证：

## 框架的定义

我们先思考几个问题：什么是框（kuàng）架（jià）？其作用又是什么？

基于[百度百科](https://baike.baidu.com/item/%E6%A1%86%E6%9E%B6/1212667)词条，框架这个概念最早应该是出于建筑学，于软件工程中最为流行，例如本文的大体结构已经构思（规划）完毕，这个结构也可称之为框架。

概念性的总结一下框架的定义：用于「支撑（架）」复杂抽象的，具有「约束性（框）」的，基本通用结构。

站在软件工程的角度上来说，框架是个半成品，当基于它补充特定的抽象之后，即可形成一个完整的软件应用。同时，框架还应该在提高效率的基础上保证质量。

## 框架设计的核心要素一：框架定位

## 框架设计的核心要素二：量身定制的 DSL

## 框架设计的核心要素三：伴生工具链及其生态

## 框架的设计能力

## 框架的实现能力

## 框架的必备能力：依赖注入

编译

第一要素：要覆盖的领域范围；
即框架定位。
跨平台？跨语言？
传统业务？游戏开发？
第二要素：量身定制一套 DSL；
VDom？IDom？NonVDom？
函数式？面向对象？
响应式？不变性？
命令式？声明式？
分层架构还是分文件夹架构？领域聚合？都主导高内聚、低耦合，你“分文件夹架构”是一点边都不沾呐
Template？JSX？Web Components？
原汁原味（React）？魔法极端（Svelte）？
迎合用户？固执己见？
这世上本没有路，走的人多了，便成了路。迪士尼乐园的路径设计
为什么公园花园里总是有人踩出来的近路，为什么在设计的时候不能直接铺近路？ - blakan 的回答 - 知乎 <https://www.zhihu.com/question/22432097/answer/21334005>
我认为固执己见会比较合适，当然，这里的固执己见应该是，有框架设计能力的人的观点。并不是说普通开发者就没有发言权，问题在于，需要站在全局的角度去发表观点。
框架理解能力 != 框架设计能力 != 框架运用能力
反正 DSL 就是发挥你的想象力，造名词、造概念！最最最重要的是，需要保持一致性，不要多范式共存。
第三要素：伴生工具链及其生态；
参考 Angular 架构
组件库？路由库？表单库？动画库？网络库？国际化？无障碍？交互式文档？图标库？图表库？
打包工具？校验工具？格式化工具？发布工具？测试工具？升级工具？语言服务？
当然以上的生态并不是说要全新实现或者做个适配器层，至少需要能做成可插拔式的插件化架构，方便与现有的社区生态集成，隔离外部不稳定性。
同时升级工具应该是必须的，因为框架需要进化，而升级工具则是帮开发者用户降低升级成本。
那么所有以上的东西，80%的实现都与编译有关，So？
什么是编译？将高级抽象降维，转化为低级抽象，直至给到底层计算机执行。
每个人都有心血来潮的时候，设计一个框架，即便不是为了解决目前解决不了或是难以解决的痛点，也是值得研究探索的，哪怕它只是一个玩具。
因为我相信每天花点时间研究，久而久之你就站在了这个领域的前沿。
可能有人会想，一开始就画这么庞大的一个蓝图，是不是有点过渡设计了，而且需要了解很多领域的知识？
我觉得有待商榷：
首先，这是基于前人所研究的基础上，再进一步的加上各自的理解而得出的“宏观概念”；
其次，软件的架构设计与建筑的架构设计有异曲同工之处。但是！软件可以在中途改变或插入许多设计，而建筑不能，建筑一旦建好，你想换个地基是不可能的，所以，建筑的架构设计必须是完完全全、方方面面都需要考虑到的。
最后，框架本身就是一个集大成者，所以了解除前端之外的其它领域，我觉得是必须的。
不然你以为 Angular 这么庞大的一个软件工程是怎么建成的？
也就是说，咱可以先幻想，至于实现，只有实践之后才能考虑具体的细节。

---

想自制一个框架有时候就是心血来潮。

也许本文对你没有参考价值，但这却是代表了我从业到目前为止的最高水平，经历的浓缩。

---

其次，有想法，特别是经验不足的情况下考虑宏大的设计问题，应该要时刻与他人或外界沟通，闭门造车虽出门合辙，但有时候容易沉浸在自己的世界里。
